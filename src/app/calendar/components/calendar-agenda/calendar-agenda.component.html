<div class="calendar-agenda margin-16">
  <!-- YEAR VIEW BEGIN -->
  <mat-grid-list
    *ngIf="stateView === 'year'"
    [cols]="viewYearCols"
    [rowHeight]="viewYearRowHeight"
  >
    <mat-grid-tile
      *ngFor="let monthString of monthStrings; let i = index"
      colspan="1"
      rowspan="1"
      ><div
        (click)="onSetMonthByClick(i)"
        class="flex flex-align-center height-100 text-hover text-hover-primary"
      >
        <div
          [ngClass]="{
            'color-primary font-size-18':
              activeYear === currentYear && i === currentMonth,
            'calendar-agenda--year-month--selected':
              activeYear === selectedYear && i === selectedMonth
          }"
          class="calendar-agenda--year-month flex flex-center
      "
        >
          <b>{{ monthString }}</b>
        </div>
      </div></mat-grid-tile
    >
  </mat-grid-list>
  <!-- YEAR VIEW END -->
  <!-- MONTH VIEW BEGIN -->
  <mat-grid-list
    *ngIf="stateView === 'month'"
    cols="7"
    [rowHeight]="viewMonthRowHeight"
  >
    <mat-grid-tile
      *ngFor="let day of dayStrings"
      colspan="1"
      rowspan="1"
      class="calendar-agenda--mat-grid-tile-title"
      ><div class="flex flex-align-center height-100 color-primary">
        <b>{{ day }}</b>
      </div></mat-grid-tile
    >
    <mat-grid-tile
      *ngFor="let prevMonthDay of prevMonthDays; let i = index"
      colspan="1"
      rowspan="2"
      class="calendar-agenda--mat-grid-tile"
    >
      <div
        class="calendar-agenda--tile-other flex flex-justify-center flex-align-center"
      >
        {{ prevMonthDay }}
      </div>
    </mat-grid-tile>
    <mat-grid-tile
      *ngFor="
        let monthDay of getMonthLength(selectedMonthLength);
        let i = index
      "
      colspan="1"
      rowspan="2"
      class="calendar-agenda--mat-grid-tile"
    >
      <div
        [ngClass]="{
          'color-primary font-size-18':
            i + 1 === currentDay &&
            selectedMonth === currentMonth &&
            selectedYear === currentYear
        }"
        (click)="openCalendarDay(i + 1)"
        class="calendar-agenda--tile flex flex-justify-center flex-align-center hover-primary margin-bottom-2 width-100"
      >
        <b>{{ i + 1 }}</b>
        <div
          *ngIf="getSelectedDayAppointmentLength(i + 1) > 0"
          class="calendar-agenda--tile-overlay font-size-12"
        >
          {{ getSelectedDayAppointmentLength(i + 1) }}
        </div>
      </div>
      <div
        *ngIf="getSelectedDayAppointmentFirst(i + 1)"
        class="flex flex-center height-100 width-100 text-hover"
        (click)="openCalendarDay(i + 1)"
      >
        <div
          class="calendar-agenda--tile-preview flex flex-justify-end font-size-12"
        >
          <div
            class="calendar-agenda--tile-preview--text margin-bottom-4 margin-right-8 margin-top-4 text-align-end text-overflow-ellipsis"
          >
            <b>{{ getSelectedDayAppointmentFirst(i + 1)?.title }}</b>
          </div>
          <div
            class="calendar-agenda--tile-preview--text margin-bottom-4 margin-right-8 margin-top-4 text-align-end text-overflow-ellipsis"
          >
            {{ getSelectedDayAppointmentFirst(i + 1)?.timeStart }} -
            {{ getSelectedDayAppointmentFirst(i + 1)?.timeEnd }}
          </div>
          <div class="calendar-agenda--tile-preview--overlay"></div>
        </div>
      </div>
    </mat-grid-tile>
    <mat-grid-tile
      *ngFor="
        let nextMonthDay of getMonthLength(nextMonthLength);
        let i = index
      "
      colspan="1"
      rowspan="2"
      class="calendar-agenda--mat-grid-tile"
    >
      <div
        class="calendar-agenda--tile-other flex flex-justify-center flex-align-center"
      >
        {{ i + 1 }}
      </div>
    </mat-grid-tile>
  </mat-grid-list>
  <!-- MONTH VIEW END -->
</div>

<div *ngIf="selectedDate" class="modal" [@modalEnter]="stateAnim">
  <div
    (click)="onCloseCalendarDay()"
    class="modal-background"
    [@modalEnterBackground]="stateAnim"
  ></div>
  <app-calendar-day
    [selectedDate]="selectedDate"
    [appointments]="appointments"
    (closeCalendarDay)="onCloseCalendarDay()"
    class="modal-content"
    [@modalEnterContent]="stateAnim"
  ></app-calendar-day>
</div>
